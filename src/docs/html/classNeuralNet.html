<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GPU Deep Learning Framework: NeuralNet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GPU Deep Learning Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classNeuralNet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">NeuralNet Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="neuralnet_8h_source.html">neuralnet.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8b1c8f50649e5627a69a5a8671b04d45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#a8b1c8f50649e5627a69a5a8671b04d45">NeuralNet</a> (bool sequential)</td></tr>
<tr class="separator:a8b1c8f50649e5627a69a5a8671b04d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45fa0d408b14fc18e6af621b621f9b2d"><td class="memItemLeft" align="right" valign="top">tensor_ptr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#a45fa0d408b14fc18e6af621b621f9b2d">predict</a> (tensor_ptr *batch, int n_batch_ins)</td></tr>
<tr class="separator:a45fa0d408b14fc18e6af621b621f9b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ababa8bfc5764960a9544183992a8305e"><td class="memItemLeft" align="right" valign="top">tensor_ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#ababa8bfc5764960a9544183992a8305e">predict</a> (tensor_ptr batch)</td></tr>
<tr class="separator:ababa8bfc5764960a9544183992a8305e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81908c988b107917a3b5a9e87223d58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#aa81908c988b107917a3b5a9e87223d58">fit</a> (tensor_ptr **x, tensor_ptr **y, int n_batches, int n_batch_ins, int n_batch_outs, int n_epochs)</td></tr>
<tr class="separator:aa81908c988b107917a3b5a9e87223d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c2a6ef2caa0cf45b3095c7ad4f5bac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#ab9c2a6ef2caa0cf45b3095c7ad4f5bac">validate_gradients</a> (tensor_ptr *x, tensor_ptr *y, int n_batch_ins, int n_batch_outs)</td></tr>
<tr class="separator:ab9c2a6ef2caa0cf45b3095c7ad4f5bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c33c6ebb75a10d3da229214bbb2cd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#a36c33c6ebb75a10d3da229214bbb2cd2">add_layer</a> (<a class="el" href="classLayer.html">Layer</a> *l)</td></tr>
<tr class="separator:a36c33c6ebb75a10d3da229214bbb2cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7289e3eea5f55b1b6d109464b1dbf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#a3e7289e3eea5f55b1b6d109464b1dbf7">add_layer</a> (<a class="el" href="classLayer.html">Layer</a> *l, bool is_output)</td></tr>
<tr class="separator:a3e7289e3eea5f55b1b6d109464b1dbf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3265e225fceb323ac4a371b1301371"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#afd3265e225fceb323ac4a371b1301371">add_output</a> (<a class="el" href="classLayer.html">Layer</a> *l)</td></tr>
<tr class="separator:afd3265e225fceb323ac4a371b1301371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83dcd1b80658d4250ebec81c932a9d33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#a83dcd1b80658d4250ebec81c932a9d33">add_loss_layer</a> (<a class="el" href="classLossLayer.html">LossLayer</a> *l)</td></tr>
<tr class="separator:a83dcd1b80658d4250ebec81c932a9d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91fb5e49b523a24764e821acbd132ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeuralNet.html#ad91fb5e49b523a24764e821acbd132ae">initialize</a> (int batch_size, <a class="el" href="classOptimizer.html">Optimizer</a> *optimizer, bool use_gpu, bool use_cpu)</td></tr>
<tr class="separator:ad91fb5e49b523a24764e821acbd132ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a8da03811ef0d7255511857cfa56494cf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8da03811ef0d7255511857cfa56494cf"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>Optimizer</b></td></tr>
<tr class="separator:a8da03811ef0d7255511857cfa56494cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed241140aad7056355cac6e44fb6fba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ed241140aad7056355cac6e44fb6fba"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>SGD</b></td></tr>
<tr class="separator:a9ed241140aad7056355cac6e44fb6fba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45604718d017cb624ca0bc1a6174251"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa45604718d017cb624ca0bc1a6174251"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>RMSProp</b></td></tr>
<tr class="separator:aa45604718d017cb624ca0bc1a6174251"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A main class of this framework, this is the one which creates the neural network and provides an interface to add layers, train it and use it for predictions </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8b1c8f50649e5627a69a5a8671b04d45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NeuralNet::NeuralNet </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sequential</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Main constructor </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequential</td><td>set this to true if the model you're using is a linear graph (each layer has 1 predecessor and 1 succesor) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a36c33c6ebb75a10d3da229214bbb2cd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::add_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLayer.html">Layer</a> *&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a layer to the network, in case of sequential model, it is automatically appended after the last previous layer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3e7289e3eea5f55b1b6d109464b1dbf7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::add_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLayer.html">Layer</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a layer with the option to mark the layer as an output one, in case of sequential model, it is automatically appended after the last previous layer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td></td></tr>
    <tr><td class="paramname">is_output</td><td>true for output layer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a83dcd1b80658d4250ebec81c932a9d33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::add_loss_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLossLayer.html">LossLayer</a> *&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds loss layer to the network, that is used for deciding the error function which is going to be minimized during training, in case of sequential model, it is automatically appended after the last previous layer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afd3265e225fceb323ac4a371b1301371"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::add_output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLayer.html">Layer</a> *&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds layer as an output, in case of sequential model, it is automatically appended after the last previous layer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa81908c988b107917a3b5a9e87223d58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::fit </td>
          <td>(</td>
          <td class="paramtype">tensor_ptr **&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tensor_ptr **&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch_outs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_epochs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function that's used to run the training of the model </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>a list of input batches, each batch is composed of components (1 for single input layer) </td></tr>
    <tr><td class="paramname">y</td><td>a list of desired outputs for each batch, also has components (1 for single output layer) </td></tr>
    <tr><td class="paramname">n_batches</td><td>a total number of batches </td></tr>
    <tr><td class="paramname">n_batch_ins</td><td>a number of components in input batch </td></tr>
    <tr><td class="paramname">n_batch_outs</td><td>a number of components in target batch </td></tr>
    <tr><td class="paramname">n_epochs</td><td>the number of epochs to train the model for (1 epoch = 1 iteration over all batches) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad91fb5e49b523a24764e821acbd132ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOptimizer.html">Optimizer</a> *&#160;</td>
          <td class="paramname"><em>optimizer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_gpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the network for training, you can enable both gpu and cpu computation this can be used to compare the gradients of both and check their correctness, otherwise select only one </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch_size</td><td>number of samples in each batch </td></tr>
    <tr><td class="paramname">optimizer</td><td>an optimizer to be used for training </td></tr>
    <tr><td class="paramname">use_gpu</td><td>true if you want to compute on gpu </td></tr>
    <tr><td class="paramname">use_cpu</td><td>true if you want to compute on cpu </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a45fa0d408b14fc18e6af621b621f9b2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tensor_ptr * NeuralNet::predict </td>
          <td>(</td>
          <td class="paramtype">tensor_ptr *&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch_ins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Use this function to acquire an output for a single batch </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch</td><td>list of batch input components (1 for single input layer) </td></tr>
    <tr><td class="paramname">n_batch_ins</td><td>number of components </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list of output components (1 for single output layer) </dd></dl>

</div>
</div>
<a class="anchor" id="ababa8bfc5764960a9544183992a8305e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tensor_ptr NeuralNet::predict </td>
          <td>(</td>
          <td class="paramtype">tensor_ptr&#160;</td>
          <td class="paramname"><em>batch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Predict function for sequention models with single input layer and single output layer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>prediction </dd></dl>

</div>
</div>
<a class="anchor" id="ab9c2a6ef2caa0cf45b3095c7ad4f5bac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeuralNet::validate_gradients </td>
          <td>(</td>
          <td class="paramtype">tensor_ptr *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tensor_ptr *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch_outs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A function which can be used to numerically check correctness of gradients. Currently works only with cpu </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>a single input batch, containts input components (1 for single input layer) </td></tr>
    <tr><td class="paramname">y</td><td>a single desired output batch, contains desired output components (1 for single output layer) </td></tr>
    <tr><td class="paramname">n_batch_ins</td><td>number of components in input batch </td></tr>
    <tr><td class="paramname">n_batch_outs</td><td>number of components in target batch </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/network/<a class="el" href="neuralnet_8h_source.html">neuralnet.h</a></li>
<li>src/network/neuralnet.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
